{"version":3,"sources":["../../../src/server/dev/log-app-dir-error.ts"],"sourcesContent":["import isError from '../../lib/is-error'\nimport * as Log from '../../build/output/log'\n\nexport function logAppDirError(err: unknown) {\n  if (isError(err) && err?.stack) {\n    const cleanedStack = err.stack.split('\\n').map((line: string) =>\n      // Remove 'webpack-internal:' noise from the path\n      line.replace(/(webpack-internal:\\/\\/\\/|file:\\/\\/)(\\(.*?\\)\\/)?/, '')\n    )\n    const filteredStack = cleanedStack\n      // Only display stack frames from the user's code\n      .filter(\n        (line: string) =>\n          !/^\\s+at.+next[\\\\/]dist[\\\\/]compiled/.test(line) &&\n          !/^\\s+at.+node_modules[\\\\/]/.test(line) &&\n          !/^\\s+at.+node:internal[\\\\/]/.test(line)\n      )\n    if (filteredStack.length === 1) {\n      // This is an error that happened outside of user code, keep full stack\n      Log.error(`Internal error: ${cleanedStack.join('\\n')}`)\n    } else {\n      Log.error(filteredStack.join('\\n'))\n    }\n    if (typeof (err as any).digest !== 'undefined') {\n      console.error(`digest: ${JSON.stringify((err as any).digest)}`)\n    }\n\n    if (err.cause) console.error('Cause:', err.cause)\n  } else {\n    Log.error(err)\n  }\n}\n"],"names":["isError","Log","logAppDirError","err","stack","cleanedStack","split","map","line","replace","filteredStack","filter","test","length","error","join","digest","console","JSON","stringify","cause"],"mappings":"AAAA,OAAOA,aAAa,qBAAoB;AACxC,YAAYC,SAAS,yBAAwB;AAE7C,OAAO,SAASC,eAAeC,GAAY;IACzC,IAAIH,QAAQG,SAAQA,uBAAAA,IAAKC,KAAK,GAAE;QAC9B,MAAMC,eAAeF,IAAIC,KAAK,CAACE,KAAK,CAAC,MAAMC,GAAG,CAAC,CAACC,OAC9C,iDAAiD;YACjDA,KAAKC,OAAO,CAAC,mDAAmD;QAElE,MAAMC,gBAAgBL,YACpB,iDAAiD;SAChDM,MAAM,CACL,CAACH,OACC,CAAC,qCAAqCI,IAAI,CAACJ,SAC3C,CAAC,4BAA4BI,IAAI,CAACJ,SAClC,CAAC,6BAA6BI,IAAI,CAACJ;QAEzC,IAAIE,cAAcG,MAAM,KAAK,GAAG;YAC9B,uEAAuE;YACvEZ,IAAIa,KAAK,CAAC,CAAC,gBAAgB,EAAET,aAAaU,IAAI,CAAC,MAAM,CAAC;QACxD,OAAO;YACLd,IAAIa,KAAK,CAACJ,cAAcK,IAAI,CAAC;QAC/B;QACA,IAAI,OAAO,AAACZ,IAAYa,MAAM,KAAK,aAAa;YAC9CC,QAAQH,KAAK,CAAC,CAAC,QAAQ,EAAEI,KAAKC,SAAS,CAAC,AAAChB,IAAYa,MAAM,EAAE,CAAC;QAChE;QAEA,IAAIb,IAAIiB,KAAK,EAAEH,QAAQH,KAAK,CAAC,UAAUX,IAAIiB,KAAK;IAClD,OAAO;QACLnB,IAAIa,KAAK,CAACX;IACZ;AACF"}