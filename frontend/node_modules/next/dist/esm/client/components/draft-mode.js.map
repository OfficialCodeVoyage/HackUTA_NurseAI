{"version":3,"sources":["../../../src/client/components/draft-mode.ts"],"sourcesContent":["import type { DraftModeProvider } from '../../server/async-storage/draft-mode-provider'\n\nimport { staticGenerationAsyncStorage } from './static-generation-async-storage.external'\nimport { trackDynamicDataAccessed } from '../../server/app-render/dynamic-rendering'\n\nexport class DraftMode {\n  /**\n   * @internal - this declaration is stripped via `tsc --stripInternal`\n   */\n  private readonly _provider: DraftModeProvider\n\n  constructor(provider: DraftModeProvider) {\n    this._provider = provider\n  }\n  get isEnabled() {\n    return this._provider.isEnabled\n  }\n  public enable() {\n    const store = staticGenerationAsyncStorage.getStore()\n    if (store) {\n      // We we have a store we want to track dynamic data access to ensure we\n      // don't statically generate routes that manipulate draft mode.\n      trackDynamicDataAccessed(store, 'draftMode().enable()')\n    }\n    return this._provider.enable()\n  }\n  public disable() {\n    const store = staticGenerationAsyncStorage.getStore()\n    if (store) {\n      // We we have a store we want to track dynamic data access to ensure we\n      // don't statically generate routes that manipulate draft mode.\n      trackDynamicDataAccessed(store, 'draftMode().disable()')\n    }\n    return this._provider.disable()\n  }\n}\n"],"names":["staticGenerationAsyncStorage","trackDynamicDataAccessed","DraftMode","isEnabled","_provider","enable","store","getStore","disable","constructor","provider"],"mappings":"AAEA,SAASA,4BAA4B,QAAQ,6CAA4C;AACzF,SAASC,wBAAwB,QAAQ,4CAA2C;AAEpF,OAAO,MAAMC;IASX,IAAIC,YAAY;QACd,OAAO,IAAI,CAACC,SAAS,CAACD,SAAS;IACjC;IACOE,SAAS;QACd,MAAMC,QAAQN,6BAA6BO,QAAQ;QACnD,IAAID,OAAO;YACT,uEAAuE;YACvE,+DAA+D;YAC/DL,yBAAyBK,OAAO;QAClC;QACA,OAAO,IAAI,CAACF,SAAS,CAACC,MAAM;IAC9B;IACOG,UAAU;QACf,MAAMF,QAAQN,6BAA6BO,QAAQ;QACnD,IAAID,OAAO;YACT,uEAAuE;YACvE,+DAA+D;YAC/DL,yBAAyBK,OAAO;QAClC;QACA,OAAO,IAAI,CAACF,SAAS,CAACI,OAAO;IAC/B;IAvBAC,YAAYC,QAA2B,CAAE;QACvC,IAAI,CAACN,SAAS,GAAGM;IACnB;AAsBF"}