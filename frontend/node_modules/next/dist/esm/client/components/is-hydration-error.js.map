{"version":3,"sources":["../../../src/client/components/is-hydration-error.ts"],"sourcesContent":["import isError from '../../lib/is-error'\n\nconst hydrationErrorRegex =\n  /hydration failed|while hydrating|content does not match|did not match/i\n\nconst reactUnifiedMismatchWarning = `Hydration failed because the server rendered HTML didn't match the client. As a result this tree will be regenerated on the client. This can happen if a SSR-ed Client Component used`\n\nconst reactHydrationErrorDocLink = 'https://react.dev/link/hydration-mismatch'\n\nexport const getDefaultHydrationErrorMessage = () => {\n  return (\n    reactUnifiedMismatchWarning +\n    '\\nSee more info here: https://nextjs.org/docs/messages/react-hydration-error'\n  )\n}\n\nexport function isHydrationError(error: unknown): boolean {\n  return isError(error) && hydrationErrorRegex.test(error.message)\n}\n\nexport function isReactHydrationErrorStack(stack: string): boolean {\n  return stack.startsWith(reactUnifiedMismatchWarning)\n}\n\nexport function getHydrationErrorStackInfo(rawMessage: string): {\n  message: string | null\n  link?: string\n  stack?: string\n  diff?: string\n} {\n  rawMessage = rawMessage.replace(/^Error: /, '')\n  if (!isReactHydrationErrorStack(rawMessage)) {\n    return { message: null }\n  }\n  rawMessage = rawMessage.slice(reactUnifiedMismatchWarning.length + 1).trim()\n  const [message, trailing] = rawMessage.split(`${reactHydrationErrorDocLink}`)\n  const trimmedMessage = message.trim()\n  // React built-in hydration diff starts with a newline, checking if length is > 1\n  if (trailing && trailing.length > 1) {\n    const stacks: string[] = []\n    const diffs: string[] = []\n    trailing.split('\\n').forEach((line) => {\n      if (line.trim() === '') return\n      if (line.trim().startsWith('at ')) {\n        stacks.push(line)\n      } else {\n        diffs.push(line)\n      }\n    })\n\n    return {\n      message: trimmedMessage,\n      link: reactHydrationErrorDocLink,\n      diff: diffs.join('\\n'),\n      stack: stacks.join('\\n'),\n    }\n  } else {\n    return {\n      message: trimmedMessage,\n      link: reactHydrationErrorDocLink,\n      stack: trailing, // without hydration diff\n    }\n  }\n}\n"],"names":["isError","hydrationErrorRegex","reactUnifiedMismatchWarning","reactHydrationErrorDocLink","getDefaultHydrationErrorMessage","isHydrationError","error","test","message","isReactHydrationErrorStack","stack","startsWith","getHydrationErrorStackInfo","rawMessage","replace","slice","length","trim","trailing","split","trimmedMessage","stacks","diffs","forEach","line","push","link","diff","join"],"mappings":"AAAA,OAAOA,aAAa,qBAAoB;AAExC,MAAMC,sBACJ;AAEF,MAAMC,8BAA+B;AAErC,MAAMC,6BAA6B;AAEnC,OAAO,MAAMC,kCAAkC;IAC7C,OACEF,8BACA;AAEJ,EAAC;AAED,OAAO,SAASG,iBAAiBC,KAAc;IAC7C,OAAON,QAAQM,UAAUL,oBAAoBM,IAAI,CAACD,MAAME,OAAO;AACjE;AAEA,OAAO,SAASC,2BAA2BC,KAAa;IACtD,OAAOA,MAAMC,UAAU,CAACT;AAC1B;AAEA,OAAO,SAASU,2BAA2BC,UAAkB;IAM3DA,aAAaA,WAAWC,OAAO,CAAC,YAAY;IAC5C,IAAI,CAACL,2BAA2BI,aAAa;QAC3C,OAAO;YAAEL,SAAS;QAAK;IACzB;IACAK,aAAaA,WAAWE,KAAK,CAACb,4BAA4Bc,MAAM,GAAG,GAAGC,IAAI;IAC1E,MAAM,CAACT,SAASU,SAAS,GAAGL,WAAWM,KAAK,CAAC,AAAC,KAAEhB;IAChD,MAAMiB,iBAAiBZ,QAAQS,IAAI;IACnC,iFAAiF;IACjF,IAAIC,YAAYA,SAASF,MAAM,GAAG,GAAG;QACnC,MAAMK,SAAmB,EAAE;QAC3B,MAAMC,QAAkB,EAAE;QAC1BJ,SAASC,KAAK,CAAC,MAAMI,OAAO,CAAC,CAACC;YAC5B,IAAIA,KAAKP,IAAI,OAAO,IAAI;YACxB,IAAIO,KAAKP,IAAI,GAAGN,UAAU,CAAC,QAAQ;gBACjCU,OAAOI,IAAI,CAACD;YACd,OAAO;gBACLF,MAAMG,IAAI,CAACD;YACb;QACF;QAEA,OAAO;YACLhB,SAASY;YACTM,MAAMvB;YACNwB,MAAML,MAAMM,IAAI,CAAC;YACjBlB,OAAOW,OAAOO,IAAI,CAAC;QACrB;IACF,OAAO;QACL,OAAO;YACLpB,SAASY;YACTM,MAAMvB;YACNO,OAAOQ;QACT;IACF;AACF"}