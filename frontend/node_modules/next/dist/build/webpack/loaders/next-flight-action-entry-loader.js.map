{"version":3,"sources":["../../../../src/build/webpack/loaders/next-flight-action-entry-loader.ts"],"sourcesContent":["import { generateActionId } from './utils'\n\nexport type NextFlightActionEntryLoaderOptions = {\n  actions: string\n}\n\nfunction nextFlightActionEntryLoader(this: any) {\n  const { actions }: NextFlightActionEntryLoaderOptions = this.getOptions()\n\n  const actionList = JSON.parse(actions) as [string, string[]][]\n  const individualActions = actionList\n    .map(([path, names]) => {\n      return names.map((name) => {\n        const id = generateActionId(path, name)\n        return [id, path, name] as [string, string, string]\n      })\n    })\n    .flat()\n\n  return `\nconst actions = {\n${individualActions\n  .map(([id, path, name]) => {\n    return `'${id}': () => import(/* webpackMode: \"eager\" */ ${JSON.stringify(\n      path\n    )}).then(mod => mod[${JSON.stringify(name)}]),`\n  })\n  .join('\\n')}\n}\n\nasync function endpoint(id, ...args) {\n  const action = await actions[id]()\n  return action.apply(null, args)\n}\n\n// Using CJS to avoid this to be tree-shaken away due to unused exports.\nmodule.exports = {\n${individualActions\n  .map(([id]) => {\n    return `  '${id}': endpoint.bind(null, '${id}'),`\n  })\n  .join('\\n')}\n}\n`\n}\n\nexport default nextFlightActionEntryLoader\n"],"names":["nextFlightActionEntryLoader","actions","getOptions","actionList","JSON","parse","individualActions","map","path","names","name","id","generateActionId","flat","stringify","join"],"mappings":";;;;+BA8CA;;;eAAA;;;uBA9CiC;AAMjC,SAASA;IACP,MAAM,EAAEC,OAAO,EAAE,GAAuC,IAAI,CAACC,UAAU;IAEvE,MAAMC,aAAaC,KAAKC,KAAK,CAACJ;IAC9B,MAAMK,oBAAoBH,WACvBI,GAAG,CAAC,CAAC,CAACC,MAAMC,MAAM;QACjB,OAAOA,MAAMF,GAAG,CAAC,CAACG;YAChB,MAAMC,KAAKC,IAAAA,uBAAgB,EAACJ,MAAME;YAClC,OAAO;gBAACC;gBAAIH;gBAAME;aAAK;QACzB;IACF,GACCG,IAAI;IAEP,OAAO,CAAC;;AAEV,EAAEP,kBACCC,GAAG,CAAC,CAAC,CAACI,IAAIH,MAAME,KAAK;QACpB,OAAO,CAAC,CAAC,EAAEC,GAAG,2CAA2C,EAAEP,KAAKU,SAAS,CACvEN,MACA,kBAAkB,EAAEJ,KAAKU,SAAS,CAACJ,MAAM,GAAG,CAAC;IACjD,GACCK,IAAI,CAAC,MAAM;;;;;;;;;;AAUd,EAAET,kBACCC,GAAG,CAAC,CAAC,CAACI,GAAG;QACR,OAAO,CAAC,GAAG,EAAEA,GAAG,wBAAwB,EAAEA,GAAG,GAAG,CAAC;IACnD,GACCI,IAAI,CAAC,MAAM;;AAEd,CAAC;AACD;MAEA,WAAef"}