{"version":3,"sources":["../../src/trace/upload-trace.ts"],"sourcesContent":["export default function uploadTrace({\n  traceUploadUrl,\n  mode,\n  projectDir,\n  distDir,\n  sync,\n}: {\n  traceUploadUrl: string\n  mode: 'dev' | 'build'\n  projectDir: string\n  distDir: string\n  sync?: boolean\n}) {\n  const { NEXT_TRACE_UPLOAD_DEBUG } = process.env\n\n  // Note: cross-spawn is not used here as it causes\n  // a new command window to appear when we don't want it to\n  const child_process =\n    require('child_process') as typeof import('child_process')\n\n  // we use spawnSync when debugging to ensure logs are piped\n  // correctly to stdout/stderr\n  const spawn =\n    NEXT_TRACE_UPLOAD_DEBUG || sync\n      ? child_process.spawnSync\n      : child_process.spawn\n\n  spawn(\n    process.execPath,\n    [\n      require.resolve('./trace-uploader'),\n      traceUploadUrl,\n      mode,\n      projectDir,\n      distDir,\n    ],\n    {\n      detached: !NEXT_TRACE_UPLOAD_DEBUG,\n      windowsHide: true,\n      shell: false,\n      ...(NEXT_TRACE_UPLOAD_DEBUG\n        ? {\n            stdio: 'inherit',\n          }\n        : {}),\n    }\n  )\n}\n"],"names":["uploadTrace","traceUploadUrl","mode","projectDir","distDir","sync","NEXT_TRACE_UPLOAD_DEBUG","process","env","child_process","require","spawn","spawnSync","execPath","resolve","detached","windowsHide","shell","stdio"],"mappings":";;;;+BAAA;;;eAAwBA;;;AAAT,SAASA,YAAY,EAClCC,cAAc,EACdC,IAAI,EACJC,UAAU,EACVC,OAAO,EACPC,IAAI,EAOL;IACC,MAAM,EAAEC,uBAAuB,EAAE,GAAGC,QAAQC,GAAG;IAE/C,kDAAkD;IAClD,0DAA0D;IAC1D,MAAMC,gBACJC,QAAQ;IAEV,2DAA2D;IAC3D,6BAA6B;IAC7B,MAAMC,QACJL,2BAA2BD,OACvBI,cAAcG,SAAS,GACvBH,cAAcE,KAAK;IAEzBA,MACEJ,QAAQM,QAAQ,EAChB;QACEH,QAAQI,OAAO,CAAC;QAChBb;QACAC;QACAC;QACAC;KACD,EACD;QACEW,UAAU,CAACT;QACXU,aAAa;QACbC,OAAO;QACP,GAAIX,0BACA;YACEY,OAAO;QACT,IACA,CAAC,CAAC;IACR;AAEJ"}