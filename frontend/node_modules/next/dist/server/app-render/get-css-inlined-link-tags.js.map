{"version":3,"sources":["../../../src/server/app-render/get-css-inlined-link-tags.tsx"],"sourcesContent":["import type { ClientReferenceManifest } from '../../build/webpack/plugins/flight-manifest-plugin'\nimport type { DeepReadonly } from '../../shared/lib/deep-readonly'\n\n/**\n * Get external stylesheet link hrefs based on server CSS manifest.\n */\nexport function getLinkAndScriptTags(\n  clientReferenceManifest: DeepReadonly<ClientReferenceManifest>,\n  filePath: string,\n  injectedCSS: Set<string>,\n  injectedScripts: Set<string>,\n  collectNewImports?: boolean\n): { styles: string[]; scripts: string[] } {\n  const filePathWithoutExt = filePath.replace(/\\.[^.]+$/, '')\n  const cssChunks = new Set<string>()\n  const jsChunks = new Set<string>()\n\n  const entryCSSFiles =\n    clientReferenceManifest.entryCSSFiles[filePathWithoutExt]\n  const entryJSFiles =\n    clientReferenceManifest.entryJSFiles?.[filePathWithoutExt] ?? []\n\n  if (entryCSSFiles) {\n    for (const file of entryCSSFiles) {\n      if (!injectedCSS.has(file)) {\n        if (collectNewImports) {\n          injectedCSS.add(file)\n        }\n        cssChunks.add(file)\n      }\n    }\n  }\n\n  if (entryJSFiles) {\n    for (const file of entryJSFiles) {\n      if (!injectedScripts.has(file)) {\n        if (collectNewImports) {\n          injectedScripts.add(file)\n        }\n        jsChunks.add(file)\n      }\n    }\n  }\n\n  return { styles: [...cssChunks], scripts: [...jsChunks] }\n}\n"],"names":["getLinkAndScriptTags","clientReferenceManifest","filePath","injectedCSS","injectedScripts","collectNewImports","filePathWithoutExt","replace","cssChunks","Set","jsChunks","entryCSSFiles","entryJSFiles","file","has","add","styles","scripts"],"mappings":";;;;+BAMgBA;;;eAAAA;;;AAAT,SAASA,qBACdC,uBAA8D,EAC9DC,QAAgB,EAChBC,WAAwB,EACxBC,eAA4B,EAC5BC,iBAA2B;QASzBJ;IAPF,MAAMK,qBAAqBJ,SAASK,OAAO,CAAC,YAAY;IACxD,MAAMC,YAAY,IAAIC;IACtB,MAAMC,WAAW,IAAID;IAErB,MAAME,gBACJV,wBAAwBU,aAAa,CAACL,mBAAmB;IAC3D,MAAMM,eACJX,EAAAA,wCAAAA,wBAAwBW,YAAY,qBAApCX,qCAAsC,CAACK,mBAAmB,KAAI,EAAE;IAElE,IAAIK,eAAe;QACjB,KAAK,MAAME,QAAQF,cAAe;YAChC,IAAI,CAACR,YAAYW,GAAG,CAACD,OAAO;gBAC1B,IAAIR,mBAAmB;oBACrBF,YAAYY,GAAG,CAACF;gBAClB;gBACAL,UAAUO,GAAG,CAACF;YAChB;QACF;IACF;IAEA,IAAID,cAAc;QAChB,KAAK,MAAMC,QAAQD,aAAc;YAC/B,IAAI,CAACR,gBAAgBU,GAAG,CAACD,OAAO;gBAC9B,IAAIR,mBAAmB;oBACrBD,gBAAgBW,GAAG,CAACF;gBACtB;gBACAH,SAASK,GAAG,CAACF;YACf;QACF;IACF;IAEA,OAAO;QAAEG,QAAQ;eAAIR;SAAU;QAAES,SAAS;eAAIP;SAAS;IAAC;AAC1D"}