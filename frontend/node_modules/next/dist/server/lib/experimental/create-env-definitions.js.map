{"version":3,"sources":["../../../../src/server/lib/experimental/create-env-definitions.ts"],"sourcesContent":["import type { Env } from '@next/env'\nimport { join } from 'node:path'\nimport { writeFile } from 'node:fs/promises'\n\nexport async function createEnvDefinitions({\n  distDir,\n  env,\n}: {\n  distDir: string\n  env: Env\n}) {\n  const envKeysStr = Object.keys(env)\n    .map((key) => `      ${key}?: string`)\n    .join('\\n')\n\n  const definitionStr = `// Type definitions for Next.js environment variables\ndeclare global {\n  namespace NodeJS {\n    interface ProcessEnv {\n${envKeysStr}\n    }\n  }\n}\nexport {}`\n\n  if (process.env.NODE_ENV === 'test') {\n    return definitionStr\n  }\n\n  try {\n    // we expect the types directory to already exist\n    const envDtsPath = join(distDir, 'types', 'env.d.ts')\n    // do not await, this is not essential for further process\n    writeFile(envDtsPath, definitionStr, 'utf-8')\n  } catch (e) {\n    console.error('Failed to write env.d.ts:', e)\n  }\n}\n"],"names":["createEnvDefinitions","distDir","env","envKeysStr","Object","keys","map","key","join","definitionStr","process","NODE_ENV","envDtsPath","writeFile","e","console","error"],"mappings":";;;;+BAIsBA;;;eAAAA;;;0BAHD;0BACK;AAEnB,eAAeA,qBAAqB,EACzCC,OAAO,EACPC,GAAG,EAIJ;IACC,MAAMC,aAAaC,OAAOC,IAAI,CAACH,KAC5BI,GAAG,CAAC,CAACC,MAAQ,CAAC,MAAM,EAAEA,IAAI,SAAS,CAAC,EACpCC,IAAI,CAAC;IAER,MAAMC,gBAAgB,CAAC;;;;AAIzB,EAAEN,WAAW;;;;SAIJ,CAAC;IAER,IAAIO,QAAQR,GAAG,CAACS,QAAQ,KAAK,QAAQ;QACnC,OAAOF;IACT;IAEA,IAAI;QACF,iDAAiD;QACjD,MAAMG,aAAaJ,IAAAA,cAAI,EAACP,SAAS,SAAS;QAC1C,0DAA0D;QAC1DY,IAAAA,mBAAS,EAACD,YAAYH,eAAe;IACvC,EAAE,OAAOK,GAAG;QACVC,QAAQC,KAAK,CAAC,6BAA6BF;IAC7C;AACF"}